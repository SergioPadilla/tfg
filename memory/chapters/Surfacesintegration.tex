\label{chapter:surfacesintegration}
En este capítulo introduciremos las herramientas de integración en superficies. Vamos a ver cómo los conceptos que conocemos para las integrales en el sentido de Lebesgue son extensibles a superficies. Enunciaremos y probaremos algunos de los resultados más utilizados en la teoría de integración como el teorema de cambio de variable o el teorema de Fubini. Por último, estudiaremos los teoremas de la divergencia que aplicaremos en capítulos posteriores.

\section{Integración en Superficies y fórmulas de integración}

Comenzamos esta sección con la definición integral para funciones sobre superficies.

\begin{definition}[Valor absoluto del Jacobiano]
Sea $\Phi: S \longrightarrow S'$ un difeomorfismo entre dos superficies. Se define el \textbf{valor absoluto del jacobiano de $\Phi$} como la aplicación
\begin{align*}
    |\text{Jac} \, \Phi|: S &\longrightarrow \rmath \\
    p &\longrightarrow |det(d\Phi)_p| = |det(M_p)|
\end{align*}
%
donde $M_p=M((d\Phi)_p, (B_1)_p, (B_2)_{\Phi(p)})$, siendo $(B_1)_p$ base ortonormal de $T_pS$ y $(B_2)_{\Phi(p)}$ base ortonormal de $T_{\Phi(p)}S'$. Esto no depende de las bases elegidas.
\end{definition}

\begin{definition}[Valor absoluto del Jacobiano para difeomorfismos en $S \times I$]
Sea $S$ una superficie, $I \subseteq \rmath$ un intervalo, $O$ abierto de $\rtres$ y sea $\Phi: S \times I \longrightarrow O$ un difeomorfismo. Se define el \textit{valor absoluto del jacobiano de $\Phi$} como la aplicación
\begin{align*}
    |\text{Jac} \, \Phi|: S \times I &\longrightarrow O \\
    (p,t) &\longrightarrow |det(d\Phi)_{(p,t)}| = |det(M_{(p,t)})|
\end{align*}
%
donde $M_{(p,t)}=M((d\Phi)_{(p,t)}, (B_1)_{(p,t)}, (B_2)_{\Phi(p,t)})$, siendo $(B_1)_{(p,t)}$ base ortonormal de $T_pS \times \rmath$ y $(B_2)_{\Phi(p,t)}$ base ortonormal de $\rtres$.
\end{definition}

\begin{definition}[Integral en $S \times \rmath$]
Sea $S$ una superficie y sea $O$ un subconjunto abierto de $\rtres$, y sea el difeomorfismo $\phi: O \longrightarrow R \times (a,b)$ con $a < b$ y $R \subset S$ un abierto relativamente compacto. Decimos que la función $h: R \times (a,b) \longrightarrow \rmath$ es integrable cuando $(h \circ \phi)|\text{Jac} \, \phi|$ sea integrable en $O$ en el sentido de Lebesgue.

En ese caso, llamaremos \textbf{integral de $h$ en $R \times (a,b)$} al número real dado por:

\begin{equation*}
    \int_{R \times (a,b)} h = \int_{R \times (a,b)} h(p, t) \, dp dt = \int_{O} (h \circ \phi)|\text{Jac} \, \phi|
\end{equation*}
\end{definition}

Esta definición es correcta, en el sentido de que no depende del difeomorfismo $\Phi: O \longrightarrow R \times (0,1)$.

\begin{definition}[Integral en $S$]
Sea $R$ una región (abierto relativamente compacto) de una superficie orientable $S$, y sea $f:R \longrightarrow \rmath$ una función cualquiera. Diremos que $f$ es integrable en $R$ cuando la función $(p,t) \in R \times (0,1) \mapsto f(p)$ sea integrable en $R \times (0,1)$. Llamaremos \textbf{integral de $f$ en $R$} al número real dado por:

\begin{equation*}
    \int_{R} f = \int_{R \times (0,1)} f(p,t) \, dp dt.
\end{equation*}
\end{definition}

\begin{definition}[Área de una superficie compacta]
Sea $S$ una superficie compacta, se define su área como:

\begin{equation*}
    A(S) = \int_S 1
\end{equation*}
\end{definition}

Algunos resultados de integración que necesitaremos son los siguientes. Se puede consultar su prueba en el capítulo 5 de \cite{montielrosbook}.

\begin{theorem}[Teorema del cambio de variable]
Sea $\phi:R_1 \longrightarrow R_2$ un difeomorfismo entre dos regiones de dos superficies orientables, y sea $f: R_2 \longrightarrow \rmath$ una función integrable. Entonces la función $(f \circ \phi)|\text{Jac} \, \phi|$ es integrable en $R_1$ y además:

\begin{equation*}
    \int_{R_2} f = \int_{R_1} (f \circ \phi)|\text{Jac} \, \phi|
\end{equation*}
\end{theorem}

\begin{theorem}[Teorema de Fubini]
Sea $R$ una región de una superficie orientable, $a,b \in \rmath, a < b$ y $h:R \times (a,b) \longrightarrow \rmath$ una función integrable en $R \times (a,b)$. Entonces, para casi todo $t \in (a,b)$, la función $p \in R \mapsto h(p,t)$ es integrable en $R$, y para casi todo $p \in R$ la función $t \in (a,b) \mapsto h(p,t)$ es integrable en $(a,b)$. Además, las funciones

\begin{equation*}
    p \in R \mapsto \int_a^b h(p,t), \quad  t \in (a,b) \mapsto \int_S h(p,t) dp
\end{equation*}
%
son integrables en $R$ y $(a,b)$ respectivamente. Finalmente, tenemos que:

\begin{equation*}
    \int_{R \times (a,b)} h(p,t) \, dpdt = \int_R \left( \int_a^b h(p,t) \, dt \right) \, dp = \int_a^b \left( \int_R h(p,t) \, dp \right) dt.
\end{equation*}
\end{theorem}


\section{Teoremas de la divergencia}
En esta sección vamos a enunciar el teorema de la divergencia y algunas consecuencias directas de este que, de nuevo, necesitaremos para demostrar algunos de los resultados más importantes en los capítulos finales.

\begin{definition}[Campo vectorial diferenciable]
Dado $A$ un subconjunto de $\rtres$, se define un \textbf{campo vectorial diferenciable} como una aplicación diferenciable $X: A \longrightarrow \rtres$.
\end{definition}

\begin{definition}[Divergencia de un campo vectorial diferenciable]
Se define la \textbf{divergencia de X} como la función $div \, X: A \longrightarrow \rmath$ dada por 
%
\begin{equation*}
    (div \, X)(p) = tr (dX)_p
\end{equation*}
%
con $p \in A$. Si $X$ se expresa como $X(p) = (X_1(p), X_2(p), X_3(p))$, entonces
%
\begin{equation*}
    (div \, X)(p) = \frac{\partial X_1}{\partial x}(p) + \frac{\partial X_2}{\partial y}(p) + \frac{\partial X_3}{\partial z}(p)
\end{equation*}
%
\end{definition}

\begin{theorem}[Teorema de la divergencia clásico]\label{divergencetheorem}
Sea $S$ una superficie conexa y compacta, y $\Omega$ el dominio interior determinado por $S$. Si $X: \overline{\Omega} \longrightarrow \rtres$ es un campo vectorial diferenciable, entonces:
%
\begin{equation*}
    \int_\Omega div \, X = -\int_S  \langle X,N \rangle
\end{equation*}
%
donde $N: S \longrightarrow \mathbb{S}^2$ es el campo unitario normal interior a lo largo de $S$.
\end{theorem}

Se puede consultar una demostración en la sección 5.7 de \cite{montielrosbook}.

\begin{definition}[Volumen encerrado por una superficie compacta]\label{volumensuperficiecompacta}
Sea $S$ una superficie compacta y $\Omega$ su dominio interior. Sea el campo vectorial diferenciable identidad $X: \overline{\Omega} \longrightarrow \rtres$ definido por $X(x) = x, \quad \forall p \in \overline{\Omega}$. Su divergencia es la función constante 3. Entonces por el teorema de divergencia:
%
\begin{equation*}
    vol \, \Omega = - \frac{1}{3} \int_S  \langle p, N(p) \rangle  dp,
\end{equation*}
%
donde $N$ es el normal unitario interior de $S$.
\end{definition}

\begin{definition}[Campo diferenciable sobre una superficie y campo diferenciable tangente]
    Sea $S$ una superficie de $\rtres$, un \textbf{campo diferenciable sobre $S$} es una aplicación diferenciable $V: S \longrightarrow \rtres$. Además, si $V(p) \in T_pS$ para cada $p \in S$ diremos que es un \textbf{campo diferenciable tangente}.
\end{definition}

\begin{definition}[Divergencia de un campo vectorial sobre una superficie]
    Sea $S$ una superficie compacta, y sea $V: S \longrightarrow \rtres$ un campo diferenciable y tangente sobre $S$. Se define la \textbf{divergencia de $V$} para $p \in S$ y $\{e_1,e_2\}$ base ortonormal de $T_pS$ como la aplicación $div_S \, V: S \longrightarrow \rmath$ definida por $(div_S \, V)(p) := \langle (dV)_p(e_1),e_1 \rangle + \langle (dV)_p(e_2),e_2 \rangle$. Esta definición no depende de la base ortonormal elegida.
\end{definition}

\begin{theorem}[Teorema de divergencia en superficies]\label{divergesurfaces}
Sea $S$ una superficie compacta y $V: S \longrightarrow \rtres$ un campo vectorial diferenciable en $S$. Entonces, tenemos:
%
\begin{equation*}
    \int_S div_S \, V = -2 \int_S \langle V,N \rangle H,
\end{equation*}
%
donde $N$ es el normal interior sobre $S$ y $H$ es la curvatura media de $S$ calculada con respecto a $N$.
\end{theorem}

Una demostración se puede encontrar en la sección 6.3 de \cite{montielrosbook}.

\begin{definition}[Gradiente]
Sea $f$ una función diferenciable sobre una superficie $S$ y $p \in S$. Consideremos la diferencial $(df)_p: T_pS \longrightarrow \rmath$. Entonces por teoría de espacios vectoriales euclídeos, existe un único $x \in T_pS$ tal que $(df)_p(v)=  \langle x,v \rangle $, $\forall v \in T_pS$.

Denotaremos $x= \gradientef $ y lo llamaremos \textbf{gradiente de $f$ en p}. Así:
%
\begin{equation*}
    \langle \gradientef, v \rangle = (df)_p(v), \qquad \forall v \in T_pS.
\end{equation*}
%
En particular, si $\{e_1, e_2\}$ es una base ortonormal se tiene:
%
\begin{equation*}
     \gradientef = \langle  \gradientef , e_1 \rangle e_1 + \langle \gradientef, e_2 \rangle e_2 = (df)_p(e_1) \, e_1 + (df)_p(e_2) \, e_2
\end{equation*}
\end{definition}

\begin{corolario}\label{corolariogradiente}
Si $f: S \longrightarrow \rmath$ es una función diferenciable sobre una superficie compacta, entonces:
%
\begin{equation*}
    \int_S \langle \gradientef, p \rangle dS + 2 \int_S f(p)dS = -2 \int_S f(p)H(p) \langle p, N(p) \rangle dS
\end{equation*}
\end{corolario}
\begin{proof}
Consideramos sobre $S$ el campo diferenciable dado por $V(p)=f(p)p$. Por la definición de divergencia, tenemos:
%
\begin{align*}
    (div_S V)(p) &= \sum_{i=1}^2 \langle (dV)_p(e_i), e_i \rangle \\
    &= \sum_{i=1}^2 (df)_p(e_i) \langle p, e_i \rangle + 2f(p),
\end{align*}
%
donde $\{e_1,e_2\}$ es cualquier base ortonormal en $T_pS$.

Por otro lado, calculando el producto escalar de $p$ con el gradiente de $f$ en $p$:
%
\begin{equation*}
    \langle p, \gradientef \rangle = \langle p, (df)_p(e_1) \, e_1 \rangle + \langle (df)_p(e_2) \, e_2 \rangle = \sum_{i=1}^2 (df)_p(e_i) \langle p, e_i \rangle 
\end{equation*}
%
y por tanto:
%
\begin{equation*}
    (div_S V)(p) = \langle \gradientef, p \rangle + 2f(p)
\end{equation*}

La demostración concluye sin más que aplicar el teorema de la divergencia para superficies \ref{divergesurfaces} al campo $V$.
\end{proof}

\section{Algunos cálculos necesarios}

Vamos calcular a partir de lo obtenido previamente el área de una esfera, el volumen de una bola, y el área y volumen encerrado por una superficie paralela.

\begin{remark}[Área de una esfera]
Veamos cuál es el área de una esfera $\mathbb{S}^2(p_0, r)$. Sabemos que:

\begin{equation*}
    A(\mathbb{S}^2(p_0, r)) = \int_{\mathbb{S}^2(p_0, r)} 1
\end{equation*}

Consideremos la traslación $T: \mathbb{S}^2(0, r) \longrightarrow \mathbb{S}^2(p_0, r)$ tal que $T(p) = p + p_0$. Usando la fórmula del cambio de variable, tenemos que:

\begin{equation*}
    \int_{\mathbb{S}^2(p_0, r)} 1 = \int_{\mathbb{S}^2(0, r)} |\text{Jac} \, T|.
\end{equation*}

Además, $|\text{Jac} \, T|=1$ por ser $T$ un movimiento rígido, luego:

\begin{equation*}
    \int_{\mathbb{S}^2(0, r)} |\text{Jac} \, T| = \int_{\mathbb{S}^2(0, r)} 1 = A(\mathbb{S}^2(0, r))
\end{equation*}

Para calcular esta integral, consideramos una parametrización de la esfera $\unitsphere (0,r)$ como una superficie de revolución: 
%
\begin{align*}
    X: \left( \frac{-\pi}{2}, \frac{\pi}{2} \right) \times (-\pi, \pi) &\longrightarrow \mathbb{S}^2(0, r) - C \\
    (t, \theta) &\longrightarrow (r\cos t\cos\theta, r\cos t\sen\theta, r\sen t)
\end{align*}
%
con $C = \{X(t,\pi) \enspace | \enspace t\in [-\pi/2, \pi/2]\}$. Por tanto, $\mathbb{S}^2(0, r) - C = X \big( (-\pi/2, \pi/2) \times (-\pi, \pi) \big)$. Como $C$ es un conjunto de medida nula, tenemos que:
%
\begin{equation*}
    \int_{\unitsphere(0, r)} 1 = \int_{\unitsphere(0, r) - C} 1.
\end{equation*}
%
Utilizando de nuevo el cambio de variable:
%
\begin{equation*}
    \int_{\unitsphere(0, r) - C} 1 = \int_{ \left( \frac{-\pi}{2}, \frac{\pi}{2} \right) \times (-\pi, \pi)} |\text{Jac} \, X| \, dtd\theta.
\end{equation*}

Calculemos el jacobiano de $X$ a partir de la definición, sea $(dX)_{(t, \theta)}: \rdos \longrightarrow T_{X(t,\theta)} \mathbb{S}^2$, tomamos la base usual en $\rdos$ y tenemos:
%
\begin{equation*}
    (dX)_{(t, \theta)}(1,0) = X_t(t, \theta) \qquad (dX)_{(t, \theta)}(0,1) = X_\theta(t, \theta).
\end{equation*}

Calculamos las derivadas y obtenemos:
%
\begin{align*}
    X_t(t, \theta) &= (-r\sen t\cos\theta, -r\sen t\sen\theta, r\cos t), \\
    X_\theta(t, \theta) &= (-r\cos t\sen\theta, r\cos t\cos\theta, 0),
\end{align*}
%
y por tanto, $\{ X_t(t, \theta), X_\theta(t, \theta) \}$ es base de $T_{X(t,\theta)} \mathbb{S}^2$, además $\langle X_t(t, \theta), X_\theta(t, \theta) \rangle = 0$ luego es una base ortogonal y solo nos falta dividir por su norma para obtener la base ortonormal:
%
\begin{align*}
    |X_t|^2 &= r^2 \\
    |X_\theta|^2 &= r^2\cos^2t
\end{align*}
%
por tanto, $|\text{Jac} \, X|(t,\theta) = |det \, M(t,\theta)|$  donde $M(t,\theta)$ es la matriz de $(dX)_{(t, \theta)}$ en las bases $\{e_1, e_2\}$ y $\left\{ \frac{X_t}{r}, \frac{X_\theta}{r\cos t} \right\}$.
%
\begin{equation*}
    M(t,\theta) = \left( {\begin{array}{cc}
        r & 0 \\
        0 & r\cos t
    \end{array} } \right)
\end{equation*}
%
Luego:
%
\begin{equation*}
    |\text{Jac} \, X|(t,\theta) = r^2\cos t
\end{equation*}
%
y, por tanto:
%
\begin{equation*}
    A(\mathbb{S}^2(0,r)) = \int_{(\frac{-\pi}{2}, \frac{\pi}{2}) \times (-\pi, \pi)} r^2\cos t \, dtd\theta = 4\pi r^2 
\end{equation*}
%
Hemos probado que:
\begin{equation*}
    A(\mathbb{S}^2(p_0,r)) = 4\pi r^2 
\end{equation*}
\end{remark}

\begin{remark}[Volumen de una bola]
Vamos a calcular el volumen de Lebesgue de una bola euclídea $B(p_0,r)=\{ p \in \rtres |p-p_0| < r \}$. Como en el cálculo del área de la esfera, consideramos la traslación, $T: B(0, r) \longrightarrow B(p_0, r)$ tal que $T(p) = p + p_0$. Aplicando la fórmula del cambio de variable y sabiendo que $|\text{Jac} \, T|=1$, tenemos:
%
\begin{equation*}
    vol \, B(p_0,r) = \int_{B(p_0,r)} 1 = \int_{B(0,r)} |\text{Jac} \, T| = \int_{B(0,r)} 1 = vol \, B(0,r).
\end{equation*}

Utilizando el teorema de la divergencia clásico \ref{divergencetheorem} con $S=\unitsphere(0,r)$ y $\Omega=B(0,r)$ y $X(p)=p$, tenemos que $(div \, X)(p)=3$, con $\forall t\in \rtres$, y nos queda:
%
\begin{align*}
    vol \, B(0,r) &= \frac{-1}{3} \int_{\mathbb{S}^2(0,r)}  \langle p, \frac{-p}{r} \rangle = \frac{-1}{3r} \int_{\mathbb{S}^2(0,r)}  \langle p, -p \rangle \\
    &= \frac{r}{3} \int_{\mathbb{S}^2(0,r)} 1
\end{align*}
%
ya que $ \langle p,p \rangle  = |p|^2 = r^2$ con $p \in \mathbb{S}^2(0,r)$.

Por tanto tenemos que $vol \, B(0,r) = \frac{r}{3}A(\unitsphere(0,r))$ utilizando la expresión para $A(\unitsphere(0,r))$ antes calculada, concluimos que:

\begin{equation*}
    vol \, B(p_0,r) = \frac{4}{3}\pi r^3.
\end{equation*}
\end{remark}

\begin{remark}[Volumen encerrado por una superficie paralela]
Sea $S$ una superficie compacta y $\epsilon > 0$ tal que $N_\epsilon(S)$ sea un entorno tubular. Hemos denotado a las superficies paralelas como $\{S_t\}_{t \in (-\epsilon, \epsilon)}$. Vamos a calcular el volumen comprendido entre $S$ y $S_t$ con $t\in (0, \epsilon)$. Sea $F: S \times (0, \epsilon) \longrightarrow V_t(S)$ definida como $F(p, t) = p + tN(p)$, donde $V_t(S)=F \big( S \times (0,\epsilon) \big)$. Sean $\Omega$ y $\Omega_t$ los dominios interiores determinados por $S$ y $S_t$, respectivamente. Teniendo en cuenta que $F$ es un difeomorfismo, tenemos:
%
\begin{equation*}
    vol \, \Omega - vol \, \Omega_t = vol \, V_t(S) = \int_{V_t(S)} 1 = \int_{S \times (0,t)} |\text{Jac} \, F|(p,t)
\end{equation*}

Calculemos $|\text{Jac} \, F|$. Dada una base ortonormal $\{e_1, e_2\}$ de direcciones principales en $p \in S$, sabemos que:
%
\begin{align*}
    (dF)_{(p,t)}(e_i,0) &= (1-tk_i(p))e_i, \qquad i = 1,2 \\
    (dF)_{(p,t)}(0,1) &= N(p)
\end{align*}

Tomando $\left\{(e_1,0), (e_2,0), (0,1)\right\}$ como base ortonormal de $T_pS \times \rmath$ y $\left\{e_1, e_2, N(p)\right\}$ como base ortonormal de $\rtres$, obtenemos:
%
\begin{align*}
    |\text{Jac} \, F|(p,t) &= \left|
  det \left( {\begin{array}{ccc}
   1 - tk_1(p) & 0 & 0 \\
   0 & 1-tk_2(p) & 0 \\
   0 & 0 & 1 \\
  \end{array} } \right) \right| \\
  &= 1 - 2tH(p) + t^2K(p)
\end{align*}

Utilizando el teorema de Fubini:

\begin{equation*}
    vol \, \Omega - vol \, \Omega_t = \int_0^t \left( \int_{S} \left( 1-2tH(p)+t^2K(p) \right) \, dp \right) dS
\end{equation*}

y, por tanto:

\begin{equation}\label{volumeparallelsurface}
    vol \, \Omega - vol \, \Omega_t = tA(S) - t^2\int_S H \, dS + \frac{t^3}{3}\int_S K \, dS.
\end{equation}
\end{remark}

\begin{remark}[Área de una superficie paralela]
Sea $S$ una superficie compacta y $\epsilon > 0$ tal que $N_\epsilon(S)$ sea un entorno tubular. Recordamos que hemos denotado a las superficies paralelas como $\{S_t\}_{t \in (-\epsilon, \epsilon)}$.

Sabemos que la función $F_t: S \longrightarrow S_t$ es un difeomorfismo, definido como $F_t(p, t) = p + tN(p)$. Utilizando el cambio de variable, tenemos:

\begin{equation*}
    A(S_t) = \int_{S_t} 1 \, dS_t = \int_S |\text{Jac} \, F_t|(p,t) \, dS
\end{equation*}

Por los cálculos previamente realizados:

\begin{align*}
    |\text{Jac} \, F_t|(p,t) &= \left|
  det \left( {\begin{array}{cc}
   1 - tk_1(p) & 0 \\
   0 & 1-tk_2(p) \\
  \end{array} } \right) \right| \\
  &= 1-2tH(p) + t^2K(p)
\end{align*}

Por tanto, tenemos que:

\begin{equation*}\label{areaparallelsurface}
    A(S_t) = A(S) -2t\int_{S} H(p) \, dS + t^2\int_{S} K(p) \, dS.
\end{equation*}
\end{remark}
